################################################################################
# Parser
################################################################################
# ------------------------------------------------------------------------------
# Parser - docker
# ------------------------------------------------------------------------------
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S %z
    ## Command      | Decoder      | Field | Optional Action
    ## =============|======================|=================
    Decode_Field_As   escaped_utf8   log     do_next
    Decode_Field_As   json           log

# ------------------------------------------------------------------------------
# Parser - pod
# ------------------------------------------------------------------------------
[PARSER]
    Name        pod
    Format      regex
    Regex       ^/var/log/containers/(?<pod_id>[^_]*)_(?<namespace>[^_]*)_(?<app_name>[^ ]*)-[0-9a-z]*.log$

# ------------------------------------------------------------------------------
# Parser - nginx
# ------------------------------------------------------------------------------
[PARSER]
    Name        nginx
    Format      regex
    Regex       ^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")
    Time_Key    time
    Time_Format %d/%b/%Y:%H:%M:%S %z

# ------------------------------------------------------------------------------
# Parser - json
# ------------------------------------------------------------------------------
# [PARSER]
#     Name        json
#     Format      json

# ------------------------------------------------------------------------------
# Parser - syslog
# ------------------------------------------------------------------------------
# [PARSER]
#     Name        syslog
#     Format      regex
#     Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
#     Time_Key    time
#     Time_Format %b %d %H:%M:%S

# ------------------------------------------------------------------------------
# Parser - network-log
# ------------------------------------------------------------------------------
# [PARSER]
#     Name        network-log
#     Format      json
#     Time_Key    timestamp
#     Time_Format %Y-%m-%dT%H:%M:%S.%L%z
